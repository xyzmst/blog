<!DOCTYPE html>
<html lang="zh">
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="referrer" content="no-referrer">
    <meta name="theme-color" content="#333333">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="google" content="notranslate">
    <meta name="format-detection" content="telephone=no">
    <meta name="keyword" content="Web, Js, CSS, Node.js, Frontend, Flutter, Docker">
    <meta name="description" content="æƒ³å†™ä»€ä¹ˆå°±å†™ä»€ä¹ˆ">
    <title>ä½¿ç”¨ Provider ç®¡ç† Flutter åº”ç”¨çŠ¶æ€ (ä¸Š) - å†·çŸ³çš„åšå®¢</title>
    <base href="/">
    <link rel="preconnect" href="//cdnjs.cloudflare.com">
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/icons/icon-72x72.png">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.9/styles/atom-one-light.min.css">
    <link rel="stylesheet" href="/styles/sanitize.css">
<link rel="stylesheet" href="/styles/cold-stone.css">
    <noscript>
      <p class="text-center">ä½ çš„æµè§ˆå™¨è¿˜æ²¡å¼€å¯ Javascript åŠŸèƒ½ï¼</p>
    </noscript>
</head>

  <body>
    

    

    <main class="main wrapper"><article class="article slide-in-right">
  <section>
    <h1 class="article-title">
      ä½¿ç”¨ Provider ç®¡ç† Flutter åº”ç”¨çŠ¶æ€ (ä¸Š)
    </h1>
    <p class="article-meta">
      <span class="meta-info">
        <span>
          æœ€åæ›´æ–°&#58; 2019-10-05 02:42:39
        </span>
        <span>å­—æ•°&#58; 1.9k</span>
        <span>é˜…è¯»æ—¶é—´&#58; 9 min</span>
      </span>
      <a  class="meta-link" href="/">è¿”å›</a>
    </p>
  </section>
  <section><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸€ä¸ªåº”ç”¨å†…é€šå¸¸ä¼šæœ‰ä¸¤ç§æ•°æ®ï¼Œéƒ¨ä»¶å†…éƒ¨çš„ä½¿ç”¨çš„ä¸´æ—¶æ€§æ•°æ®ä»¥åŠå¾ˆå¤šéƒ¨ä»¶ä½¿ç”¨çš„å…¨å±€æ€§æ•°æ®ï¼Œéƒ¨ä»¶å†…éƒ¨ä½¿ç”¨çš„æ•°æ®å¯ä»¥é€šè¿‡ StatefulWidget æ¥ç®¡ç†ï¼Œä½†æ˜¯å…¨å±€æ€§çš„æ•°æ®å¦‚æœé€šè¿‡ä»ä¸Šåˆ°ä¸‹ä¼ é€’çš„æ–¹å¼ä¼šä½¿ä»£ç å†™çš„ååˆ†ç¹çï¼Œè¿™æ—¶å°±éœ€è¦ä¸€ä¸ªçŠ¶æ€ç®¡ç†å·¥å…·æ¥è¿›è¡Œç®¡ç†äº†ï¼Œæœ¬æ–‡è¯´æ˜å¦‚ä½•ä½¿ç”¨ Provider æ¥ç®¡ç†è¿™ç§åº”ç”¨çš„å…¨å±€æ€§çš„æ•°æ®</p>
<h2 id="ä»€ä¹ˆæ˜¯-Provider"><a href="#ä»€ä¹ˆæ˜¯-Provider" class="headerlink" title="ä»€ä¹ˆæ˜¯ Provider"></a>ä»€ä¹ˆæ˜¯ Provider</h2><p>å®˜æ–¹çš„å®šä¹‰æ˜¯ï¼š A mixture between dependency injection (DI) and state management, built with widgets for widgets. ç¿»è¯‘è¿‡æ¥å¤§æ„æ˜¯ä¸€ç§ä¾èµ–æ³¨å…¥å’ŒçŠ¶æ€ç®¡ç†çš„æ··åˆæ–¹æ¡ˆï¼Œä½¿ç”¨éƒ¨ä»¶åˆ›å»ºï¼Œä½œç”¨äºéƒ¨ä»¶ ğŸ˜…</p>
<p><a href="https://pub.flutter-io.cn/documentation/provider/latest/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<h2 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Provider"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Provider" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Provider"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Provider</h2><p>åº”ç”¨ä¸­é€šå¸¸ä¼šæœ‰ä¸€äº›å¾ˆå¤šéƒ¨ä»¶éƒ½éœ€è¦çš„æ•°æ®ï¼Œå¦‚ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼Œç”¨æˆ·è®¾ç½®ï¼Œåœ°ç†ä½ç½®ç­‰ï¼Œå¦‚æœåªæ˜¯ä½¿ç”¨ StatefullWeight çš„è¯å°±éœ€è¦å°†çŠ¶æ€æå‡åˆ°ä¸€ä¸ªçˆ¶éƒ¨ä»¶ä¸­ç„¶åå‘ä¸‹è¿›è¡Œä¼ é€’ï¼Œä¼šå¾ˆç¹çï¼Œä½¿ç”¨ provider çš„è¯å¯ä»¥å°†å¯¹ä¸€ç§çŠ¶æ€æ•°æ®çš„æ“ä½œæ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å†…ï¼Œç„¶åä½¿ç”¨åˆ°è¿™ä¸ªæ•°æ®çš„éƒ¨ä»¶åªéœ€è¦ä½¿ç”¨å°±å¯ä»¥äº†ï¼Œå½“æ•°æ®æœ‰å˜åŒ–æ—¶ï¼Œéƒ¨ä»¶ä¼šè‡ªåŠ¨çš„é‡æ–°æ„å»ºï¼Œä½¿ç•Œé¢æ›´æ–°ã€‚</p>
<h2 id="ä¸€ä¸ªä¾‹å­-ğŸŒ°"><a href="#ä¸€ä¸ªä¾‹å­-ğŸŒ°" class="headerlink" title="ä¸€ä¸ªä¾‹å­ ğŸŒ°"></a>ä¸€ä¸ªä¾‹å­ ğŸŒ°</h2><p>ä½¿ç”¨ä¸€ä¸ª todo åº”ç”¨æ¥è¯´æ˜å¦‚ä½•åœ¨ Flutter åº”ç”¨ä¸­ä½¿ç”¨ Providerï¼Œæœ€ç»ˆçš„å®Œæˆçš„åº”ç”¨æ˜¯è¿™æ ·çš„ï¼Œå¯ä»¥æ–°å¢ï¼Œç¼–è¾‘å’Œåˆ é™¤ todoã€‚</p>
<p><a href="https://github.com/xrr2016/flutter_provider_todos" target="_blank" rel="noopener">æºç åœ°å€</a></p>
<img src="images/provider-todos.png" width="360" style="width: 360px;">

<h3 id="åˆ›å»ºåº”ç”¨"><a href="#åˆ›å»ºåº”ç”¨" class="headerlink" title="åˆ›å»ºåº”ç”¨"></a>åˆ›å»ºåº”ç”¨</h3><p>é¦–å…ˆä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter create flutter_provider_todos</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨é¡¹ç›®çš„ pubspec.yml æ·»åŠ  provider</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span></span><br><span class="line"><span class="attr">  provider:</span> <span class="string">^3.1.0</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ª store æ–‡ä»¶å¤¹ä»¥åŠ todos.dart ç”¨æ¥å­˜æ”¾åº”ç”¨ä¸­éœ€è¦ç”¨åˆ°çš„å…¨å±€æ€§æ•°æ®ï¼Œæ–°å»ºä¸€ä¸ª widget ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾åº”ç”¨ä¸­çš„éƒ¨ä»¶ä»¥åŠä¸€ä¸ªæ˜¾ç¤º todo çš„é¡µé¢ todos_page.dart</p>
<img src="images/todos-folder.jpg" width="360" style="width: 360px;">

<p>é¦–å…ˆåˆ›å»º todos è¿™ä¸ªå…¨å±€æ€§çš„æ•°æ®ï¼Œä¿®æ”¹ store/todos.dartï¼Œåˆ›å»ºä¸€ä¸ª Todo ç±»è¡¨ç¤ºä¸€ä¸ªä»£åŠäº‹é¡¹ï¼Œç„¶åå®ç° Todos ç±»ï¼Œ Todos æ··åˆäº† ChangeNotifier ç±»ï¼Œä¸ºäº†ä½¿ç”¨ notifyListeners æ–¹æ³•æ¥é€šçŸ¥ UI æ›´æ–°ï¼Œå› æ­¤éœ€è¦å¯¼å…¥ foundation.dartï¼ŒTodos ç±»ä½¿ç”¨ä¸€ä¸ª _items æ•°ç»„å­˜æ”¾ Todo æ•°æ®ï¼Œä»¥åŠå…¶å®ƒå¯¹ Todo è¿›è¡Œæ“ä½œçš„æ–¹æ³•ã€‚</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/foundation.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> </span>&#123;</span><br><span class="line">  <span class="built_in">bool</span> finish;</span><br><span class="line">  <span class="built_in">String</span> thing;</span><br><span class="line"></span><br><span class="line">  Todo(&#123;</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.thing,</span><br><span class="line">    <span class="keyword">this</span>.finish = <span class="keyword">false</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todos</span> <span class="keyword">extends</span> <span class="title">ChangeNotifier</span> </span>&#123;</span><br><span class="line">  <span class="built_in">List</span>&lt;Todo&gt; _items = [</span><br><span class="line">    Todo(thing: <span class="string">'Play lol'</span>, finish: <span class="keyword">true</span>),</span><br><span class="line">    Todo(thing: <span class="string">'Learn flutter'</span>, finish: <span class="keyword">false</span>),</span><br><span class="line">    Todo(thing: <span class="string">'Read book'</span>, finish: <span class="keyword">false</span>),</span><br><span class="line">    Todo(thing: <span class="string">'Watch anime'</span>, finish: <span class="keyword">false</span>),</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> items &#123;</span><br><span class="line">    <span class="keyword">return</span> [..._items];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> finishTodos &#123;</span><br><span class="line">    <span class="keyword">return</span> _items.where((todo) =&gt; todo.finish);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> refresh() &#123;</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> addTodo(Todo todo) &#123;</span><br><span class="line">    _items.insert(<span class="number">0</span>, todo);</span><br><span class="line"></span><br><span class="line">    refresh();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> removeTodo(<span class="built_in">int</span> index) &#123;</span><br><span class="line">    _items.removeAt(index);</span><br><span class="line"></span><br><span class="line">    refresh();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> editTodo(<span class="built_in">int</span> index, <span class="built_in">String</span> newThing, <span class="built_in">bool</span> isFinish) &#123;</span><br><span class="line">    Todo todo = _items[index];</span><br><span class="line">    todo.thing = newThing;</span><br><span class="line">    todo.finish = isFinish;</span><br><span class="line"></span><br><span class="line">    refresh();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> toggleFinish(<span class="built_in">int</span> index) &#123;</span><br><span class="line">    <span class="keyword">final</span> todo = _items[index];</span><br><span class="line">    todo.finish = !todo.finish;</span><br><span class="line"></span><br><span class="line">    refresh();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool</span> isTodoExist(<span class="built_in">String</span> thing) &#123;</span><br><span class="line">    <span class="built_in">bool</span> isExist = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; _items.length; i++) &#123;</span><br><span class="line">      <span class="keyword">final</span> todo = _items[i];</span><br><span class="line">      <span class="keyword">if</span> (todo.thing == thing) &#123;</span><br><span class="line">        isExist = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isExist;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨ provider æä¾›çš„ ChangeNotifierProvider æ–¹æ³•å°†æ•°æ®æ³¨å†Œåˆ°æ•´ä¸ªåº”ç”¨ï¼Œå¦‚æœæœ‰å¤šä¸ªæ•°æ®å°±éœ€è¦ä½¿ç”¨ MultiProvider æ–¹æ³•</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:provider/provider.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'todos_page.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'store/todos.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() =&gt; runApp(MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Todos'</span>,</span><br><span class="line">      debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">      theme: ThemeData(</span><br><span class="line">        primarySwatch: Colors.green,</span><br><span class="line">      ),</span><br><span class="line">      home: ChangeNotifierProvider(</span><br><span class="line">        builder: (context) =&gt; Todos(),</span><br><span class="line">        child: TodosPage(),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ—è¡¨é¡µé¢"><a href="#åˆ—è¡¨é¡µé¢" class="headerlink" title="åˆ—è¡¨é¡µé¢"></a>åˆ—è¡¨é¡µé¢</h3><p>æ¥ç€å°±æ˜¯å®ç°æ˜¾ç¤º todo åˆ—è¡¨çš„é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢å°±æ˜¯è¦ç”¨åˆ° Todos ç±»é‡Œé¢çš„æ•°æ®çš„éƒ¨ä»¶ï¼Œè¦ä½¿ç”¨ provider çš„æ•°æ®é¦–å…ˆè¦å¯¼å…¥ provider ä»¥åŠå¯¹åº”çš„æ•°æ®ç±» Todosï¼Œç„¶åç”¨ Consumer åŠ ç±»å‹ Todos æ¥ä½¿ç”¨è¿™ä¸ªæ•°æ®</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;Todos&gt;(</span><br><span class="line">  builder: (ctx, todos, child) &#123;</span><br><span class="line">    <span class="keyword">return</span> YourWidget()</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé¡µé¢ä½¿ç”¨äº†ä¸€ä¸ª ListView.builder() æ¥æ¸²æŸ“ Todosï¼Œç„¶åæ¯ä¸€é¡¹ä½¿ç”¨ä¸€ä¸ª ListTile å±•ç¤ºã€‚æ–°å¢ï¼Œç¼–è¾‘å’Œåˆ é™¤å¯¹åº”äº† 3 ä¸ªä¸åŒçš„éƒ¨ä»¶ï¼Œåˆ†åˆ«æ˜¯ AddTodoButton()ï¼ŒEditTodoButton()ï¼Œ RemoveTodoButton()</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// todos_page.dart</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:provider/provider.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'store/todos.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'widget/add_todo_button.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'widget/edit_todo_button.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'widget/remove_todo_button.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodosPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(title: Text(<span class="string">'Flutter Provider Todos'</span>)),</span><br><span class="line">      body: Consumer&lt;Todos&gt;(</span><br><span class="line">        builder: (ctx, todos, child) &#123;</span><br><span class="line">          <span class="built_in">List</span>&lt;Todo&gt; items = todos.items;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">return</span> ListView.builder(</span><br><span class="line">            itemCount: items.length,</span><br><span class="line">            itemBuilder: (_, index) =&gt; Column(</span><br><span class="line">              children: &lt;Widget&gt;[</span><br><span class="line">                ListTile(</span><br><span class="line">                  title: Text(</span><br><span class="line">                    items[index].thing,</span><br><span class="line">                    style: TextStyle(</span><br><span class="line">                      color: items[index].finish ? Colors.green : Colors.grey,</span><br><span class="line">                    ),</span><br><span class="line">                  ),</span><br><span class="line">                  trailing: Container(</span><br><span class="line">                    width: <span class="number">150</span>,</span><br><span class="line">                    child: Row(</span><br><span class="line">                      mainAxisAlignment: MainAxisAlignment.end,</span><br><span class="line">                      children: &lt;Widget&gt;[</span><br><span class="line">                        EditTodoButton(todoIndex: index),</span><br><span class="line">                        RemoveTodoButton(todoIndex: index),</span><br><span class="line">                      ],</span><br><span class="line">                    ),</span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                Divider(),</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton: AddTodoButton(),</span><br><span class="line">      floatingActionButtonLocation: FloatingActionButtonLocation.centerFloat,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®ç°åŠŸèƒ½"><a href="#å®ç°åŠŸèƒ½" class="headerlink" title="å®ç°åŠŸèƒ½"></a>å®ç°åŠŸèƒ½</h3><p>æ¥ä¸‹æ¥å°±æ˜¯è¦å®ç°è¿™ 3 ä¸ªæŒ‰é’®äº†ï¼Œåœ¨ widget ç›®å½•åˆ›å»ºå¯¹åº”çš„æ–‡ä»¶ï¼Œæ¯ä¸ªæŒ‰é’®éƒ½ä¼šä½¿ç”¨åˆ° Todos ç±»é‡Œé¢å®šä¹‰çš„æ–¹æ³•ï¼Œæ‰€ä»¥éƒ½éœ€è¦å¯¼å…¥ provider å’Œ Todos ç±»ï¼Œç‚¹å‡»æŒ‰é’®ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†è¯¢é—®å¯¹åº”çš„æ“ä½œï¼Œ</p>
<img src="images/todos-widget.jpg" style="width: 360px;">

<p>æ·»åŠ  Todo æŒ‰é’®</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:provider/provider.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../store/todos.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddTodoButton</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _AddTodoButtonState createState() =&gt; _AddTodoButtonState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_AddTodoButtonState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">AddTodoButton</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> _formKey = GlobalKey&lt;FormState&gt;();</span><br><span class="line">  <span class="keyword">final</span> _controller = TextEditingController();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _formKey.currentState.dispose();</span><br><span class="line">    _controller.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Consumer&lt;Todos&gt;(</span><br><span class="line">      builder: (_, todos, child) &#123;</span><br><span class="line">        <span class="keyword">return</span> FloatingActionButton(</span><br><span class="line">          child: Icon(Icons.add),</span><br><span class="line">          onPressed: () &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'add todo'</span>);</span><br><span class="line">            <span class="keyword">return</span> showDialog(</span><br><span class="line">              context: context,</span><br><span class="line">              builder: (BuildContext _) &#123;</span><br><span class="line">                <span class="keyword">return</span> SimpleDialog(</span><br><span class="line">                  title: Text(<span class="string">'æ·»åŠ  Todo'</span>),</span><br><span class="line">                  contentPadding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">24.0</span>),</span><br><span class="line">                  children: &lt;Widget&gt;[</span><br><span class="line">                    Form(</span><br><span class="line">                      key: _formKey,</span><br><span class="line">                      child: Column(</span><br><span class="line">                        children: &lt;Widget&gt;[</span><br><span class="line">                          TextFormField(</span><br><span class="line">                            autofocus: <span class="keyword">true</span>,</span><br><span class="line">                            autovalidate: <span class="keyword">false</span>,</span><br><span class="line">                            controller: _controller,</span><br><span class="line">                            keyboardType: TextInputType.text,</span><br><span class="line">                            decoration: InputDecoration(</span><br><span class="line">                              border: OutlineInputBorder(),</span><br><span class="line">                              labelText: <span class="string">'è¾“å…¥ä½ æƒ³åšçš„äº‹'</span>,</span><br><span class="line">                            ),</span><br><span class="line">                            validator: (val) &#123;</span><br><span class="line">                              <span class="keyword">if</span> (val.isEmpty) &#123;</span><br><span class="line">                                <span class="keyword">return</span> <span class="string">'æƒ³åšçš„äº‹ä¸èƒ½ä¸ºç©º'</span>;</span><br><span class="line">                              &#125;</span><br><span class="line"></span><br><span class="line">                              <span class="built_in">bool</span> isExist = todos.isTodoExist(val);</span><br><span class="line"></span><br><span class="line">                              <span class="keyword">if</span> (isExist) &#123;</span><br><span class="line">                                <span class="keyword">return</span> <span class="string">'è¿™ä»¶äº‹æƒ…å·²ç»å­˜åœ¨äº†'</span>;</span><br><span class="line">                              &#125;</span><br><span class="line">                              <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                            &#125;,</span><br><span class="line">                          ),</span><br><span class="line">                          SizedBox(height: <span class="number">20</span>),</span><br><span class="line">                          Row(</span><br><span class="line">                            mainAxisAlignment: MainAxisAlignment.end,</span><br><span class="line">                            children: &lt;Widget&gt;[</span><br><span class="line">                              FlatButton(</span><br><span class="line">                                child: Text(<span class="string">'å–æ¶ˆ'</span>),</span><br><span class="line">                                onPressed: () &#123;</span><br><span class="line">                                  Navigator.pop(context);</span><br><span class="line">                                &#125;,</span><br><span class="line">                              ),</span><br><span class="line">                              RaisedButton(</span><br><span class="line">                                child: Text(</span><br><span class="line">                                  <span class="string">'ç¡®å®š'</span>,</span><br><span class="line">                                  style: TextStyle(color: Colors.white),</span><br><span class="line">                                ),</span><br><span class="line">                                color: Theme.of(context).primaryColor,</span><br><span class="line">                                onPressed: () &#123;</span><br><span class="line">                                  <span class="keyword">final</span> isValid =</span><br><span class="line">                                      _formKey.currentState.validate();</span><br><span class="line"></span><br><span class="line">                                  <span class="keyword">if</span> (!isValid) &#123;</span><br><span class="line">                                    <span class="keyword">return</span>;</span><br><span class="line">                                  &#125;</span><br><span class="line"></span><br><span class="line">                                  <span class="keyword">final</span> thing = _controller.value.text;</span><br><span class="line"></span><br><span class="line">                                  todos.addTodo(Todo(</span><br><span class="line">                                    thing: thing,</span><br><span class="line">                                    finish: <span class="keyword">false</span>,</span><br><span class="line">                                  ));</span><br><span class="line">                                  _controller.clear();</span><br><span class="line">                                  Navigator.pop(context);</span><br><span class="line">                                &#125;,</span><br><span class="line">                              )</span><br><span class="line">                            ],</span><br><span class="line">                          ),</span><br><span class="line">                        ],</span><br><span class="line">                      ),</span><br><span class="line">                    ),</span><br><span class="line">                  ],</span><br><span class="line">                );</span><br><span class="line">              &#125;,</span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://github.com/xrr2016/flutter_provider_todos/raw/master/add-todo.png" width="360" style="width: 360px;">

<p>ç¼–è¾‘ Todo æŒ‰é’®</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:provider/provider.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../store/todos.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EditTodoButton</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> todoIndex;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> EditTodoButton(&#123;Key key, <span class="keyword">this</span>.todoIndex&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _EditTodoButtonState createState() =&gt; _EditTodoButtonState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_EditTodoButtonState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">EditTodoButton</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> _formKey = GlobalKey&lt;FormState&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _formKey?.currentState?.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Consumer&lt;Todos&gt;(</span><br><span class="line">      builder: (context, todos, child) &#123;</span><br><span class="line">        <span class="keyword">final</span> todoIndex = widget.todoIndex;</span><br><span class="line">        <span class="keyword">final</span> Todo todo = todos.items[todoIndex];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> IconButton(</span><br><span class="line">          color: Colors.blue,</span><br><span class="line">          icon: Icon(Icons.edit),</span><br><span class="line">          onPressed: () &#123;</span><br><span class="line">            <span class="keyword">return</span> showDialog(</span><br><span class="line">              context: context,</span><br><span class="line">              builder: (context) &#123;</span><br><span class="line">                <span class="keyword">return</span> SimpleDialog(</span><br><span class="line">                  title: Text(<span class="string">'ç¼–è¾‘ Todo'</span>),</span><br><span class="line">                  contentPadding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">24.0</span>),</span><br><span class="line">                  children: &lt;Widget&gt;[</span><br><span class="line">                    Form(</span><br><span class="line">                      key: _formKey,</span><br><span class="line">                      child: Column(</span><br><span class="line">                        children: &lt;Widget&gt;[</span><br><span class="line">                          TextFormField(</span><br><span class="line">                            autofocus: <span class="keyword">false</span>,</span><br><span class="line">                            autovalidate: <span class="keyword">false</span>,</span><br><span class="line">                            initialValue: todo.thing,</span><br><span class="line">                            decoration: InputDecoration(</span><br><span class="line">                              border: OutlineInputBorder(),</span><br><span class="line">                              labelText: <span class="string">'è¾“å…¥ä½ æƒ³åšçš„äº‹'</span>,</span><br><span class="line">                            ),</span><br><span class="line">                            onChanged: (val) &#123;</span><br><span class="line">                              todo.thing = val;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            validator: (val) &#123;</span><br><span class="line">                              <span class="keyword">if</span> (val.isEmpty) &#123;</span><br><span class="line">                                <span class="keyword">return</span> <span class="string">'æƒ³åšçš„äº‹ä¸èƒ½ä¸ºç©º'</span>;</span><br><span class="line">                              &#125;</span><br><span class="line">                              <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                            &#125;,</span><br><span class="line">                          ),</span><br><span class="line">                          SizedBox(height: <span class="number">20</span>),</span><br><span class="line">                          SwitchListTile(</span><br><span class="line">                            title: <span class="keyword">const</span> Text(<span class="string">'æ˜¯å¦å®Œæˆ'</span>),</span><br><span class="line">                            value: todo.finish,</span><br><span class="line">                            onChanged: (<span class="built_in">bool</span> value) &#123;</span><br><span class="line">                              todo.finish = value;</span><br><span class="line">                            &#125;,</span><br><span class="line">                          ),</span><br><span class="line">                          SizedBox(height: <span class="number">20</span>),</span><br><span class="line">                          Row(</span><br><span class="line">                            mainAxisAlignment: MainAxisAlignment.end,</span><br><span class="line">                            children: &lt;Widget&gt;[</span><br><span class="line">                              FlatButton(</span><br><span class="line">                                child: Text(<span class="string">'å–æ¶ˆ'</span>),</span><br><span class="line">                                onPressed: () =&gt; Navigator.pop(context),</span><br><span class="line">                              ),</span><br><span class="line">                              RaisedButton(</span><br><span class="line">                                child: Text(</span><br><span class="line">                                  <span class="string">'ç¡®å®š'</span>,</span><br><span class="line">                                  style: TextStyle(color: Colors.white),</span><br><span class="line">                                ),</span><br><span class="line">                                color: Theme.of(context).primaryColor,</span><br><span class="line">                                onPressed: () &#123;</span><br><span class="line">                                  <span class="keyword">final</span> isValid =</span><br><span class="line">                                      _formKey.currentState.validate();</span><br><span class="line"></span><br><span class="line">                                  <span class="keyword">if</span> (!isValid) &#123;</span><br><span class="line">                                    <span class="keyword">return</span>;</span><br><span class="line">                                  &#125;</span><br><span class="line"></span><br><span class="line">                                  Navigator.pop(context);</span><br><span class="line"></span><br><span class="line">                                  todos.editTodo(</span><br><span class="line">                                    todoIndex,</span><br><span class="line">                                    todo.thing,</span><br><span class="line">                                    todo.finish,</span><br><span class="line">                                  );</span><br><span class="line">                                &#125;,</span><br><span class="line">                              )</span><br><span class="line">                            ],</span><br><span class="line">                          ),</span><br><span class="line">                        ],</span><br><span class="line">                      ),</span><br><span class="line">                    ),</span><br><span class="line">                  ],</span><br><span class="line">                );</span><br><span class="line">              &#125;,</span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://github.com/xrr2016/flutter_provider_todos/raw/master/edit-todo.png" width="360" style="width: 360px;">

<p>åˆ é™¤ Todo æŒ‰é’®</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:provider/provider.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../store/todos.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RemoveTodoButton</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> todoIndex;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> RemoveTodoButton(&#123;Key key, <span class="keyword">this</span>.todoIndex&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Consumer&lt;Todos&gt;(builder: (_, todos, child) &#123;</span><br><span class="line">      <span class="keyword">final</span> Todo todo = todos.items[todoIndex];</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> IconButton(</span><br><span class="line">        color: Colors.red,</span><br><span class="line">        icon: Icon(Icons.delete),</span><br><span class="line">        onPressed: () &#123;</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">'delete todo'</span>);</span><br><span class="line">          showDialog(</span><br><span class="line">            context: context,</span><br><span class="line">            builder: (BuildContext context) &#123;</span><br><span class="line">              <span class="keyword">return</span> AlertDialog(</span><br><span class="line">                title: Text(<span class="string">'ç¡®è®¤åˆ é™¤ <span class="subst">$&#123;todo.thing&#125;</span>?'</span>),</span><br><span class="line">                actions: &lt;Widget&gt;[</span><br><span class="line">                  FlatButton(</span><br><span class="line">                    child: Text(</span><br><span class="line">                      <span class="string">'å–æ¶ˆ'</span>,</span><br><span class="line">                      style: TextStyle(color: Colors.grey),</span><br><span class="line">                    ),</span><br><span class="line">                    onPressed: () =&gt; Navigator.pop(context),</span><br><span class="line">                  ),</span><br><span class="line">                  FlatButton(</span><br><span class="line">                    child: Text(<span class="string">'ç¡®è®¤'</span>),</span><br><span class="line">                    onPressed: () &#123;</span><br><span class="line">                      todos.removeTodo(todoIndex);</span><br><span class="line">                      Navigator.pop(context);</span><br><span class="line">                    &#125;,</span><br><span class="line">                  ),</span><br><span class="line">                ],</span><br><span class="line">              );</span><br><span class="line">            &#125;,</span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://github.com/xrr2016/flutter_provider_todos/raw/master/remove-todo.png" width="360" style="width: 360px;">

<p>å¯ä»¥çœ‹åˆ°è¦ä½¿ç”¨å¯¹åº”çš„æ–¹æ³•éœ€è¦çš„åªæ˜¯å‘å¯¹åº”çš„éƒ¨ä»¶æ³¨å…¥è¿™ä¸ªæ•°æ®ï¼Œç„¶åä½¿ç”¨å°±å¯ä»¥äº†</p>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>ä½¿ç”¨äº† provider åï¼Œæ•°æ®ä»¥åŠå¯¹ä¸€ä¸ª Todo çš„æ“ä½œéƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢äº†ï¼Œä¸ç”¨åœ¨å¤šä¸ªå±‚çº§é—´ä¼ é€’æ•°æ®ï¼Œå¹¶ä¸”åœ¨æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°äº† UIï¼Œæ‰€ä»¥æ˜¯ååˆ†æœ‰å¿…è¦çš„ã€‚</p></section>
</article>

<section class="card article-toc">
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å‰è¨€"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä»€ä¹ˆæ˜¯-Provider"><span class="toc-text">ä»€ä¹ˆæ˜¯ Provider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Provider"><span class="toc-text">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Provider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸€ä¸ªä¾‹å­-ğŸŒ°"><span class="toc-text">ä¸€ä¸ªä¾‹å­ ğŸŒ°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ›å»ºåº”ç”¨"><span class="toc-text">åˆ›å»ºåº”ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ—è¡¨é¡µé¢"><span class="toc-text">åˆ—è¡¨é¡µé¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å®ç°åŠŸèƒ½"><span class="toc-text">å®ç°åŠŸèƒ½</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç»“è¯­"><span class="toc-text">ç»“è¯­</span></a></li></ol>
</section>

<section class="article slide-in-right">

  <div class="loader" id="loader">
    <svg viewBox="0 0 50 50">
      <circle class="ring" cx="25" cy="25" r="20"></circle>
      <circle class="ball" cx="25" cy="5" r="3.5"></circle>
    </svg>
  </div>

  <div class="comment" id="utteranc"></div>
  <noscript>Please activate JavaScript for normal use of comments</noscript>
</section>

<a class="card back-to-top" id="backTop">&UpArrow;</a>

</main>

    

    <script>
	window.COLD_STONE = {
	  repo: "",
	  gaid: "UA-119658292-2"
	}
</script>


	<script>
		window.COLD_STONE.repo = "xrr2016/blog"
	</script>


<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.9/highlight.min.js"></script>
<script src="/scripts/cold-stone.js"></script>

<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


  <script src="//www.googletagmanager.com/gtag/js?id=UA-119658292-2"></script>

  <script>
	window.dataLayer = window.dataLayer || []
	function gtag() {
		dataLayer.push(arguments)
	}
	gtag('js', new Date())
	gtag('config', window.COLD_STONE.gaid)
  </script>


  </body>
</html>
